---
phase: 26-validation-archive
plan: 02
type: execute
wave: 2
depends_on: ["26-01"]
files_modified:
  - workflows-backup/holwGQuksZPsSb19-status-pre-checkin.json
  - workflows-backup/NUZv1Gt15LKyiiKz-buscar-instrucoes.json
  - workflows-backup/Pc0PyATrZaGefiSJ-processar-documento.json
  - workflows-backup/README.md
autonomous: true

must_haves:
  truths:
    - "All 10 sub-workflows are exported to workflows-backup/ directory"
    - "All 10 sub-workflows are deactivated in N8N (not deleted)"
    - "Exported JSON files are valid and can be re-imported"
    - "README.md is updated with archive completion status"
  artifacts:
    - path: "workflows-backup/holwGQuksZPsSb19-status-pre-checkin.json"
      provides: "Backup of status_pre_checkin sub-workflow"
      min_lines: 10
    - path: "workflows-backup/NUZv1Gt15LKyiiKz-buscar-instrucoes.json"
      provides: "Backup of buscar_instrucoes sub-workflow"
      min_lines: 10
    - path: "workflows-backup/Pc0PyATrZaGefiSJ-processar-documento.json"
      provides: "Backup of processar_documento sub-workflow"
      min_lines: 10
  key_links:
    - from: "workflows-backup/*.json"
      to: "N8N import"
      via: "valid JSON with nodes and connections"
      pattern: "\"nodes\".*\"connections\""
---

<objective>
Export missing sub-workflows and deactivate all 10 replaced sub-workflows in N8N.

Purpose: Complete the migration cleanup by archiving sub-workflows for rollback capability while deactivating them to prevent confusion.
Output: All 10 sub-workflows backed up to git and deactivated in N8N.
</objective>

<execution_context>
@/Users/gilberto/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gilberto/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/26-validation-archive/26-RESEARCH.md
@.planning/phases/26-validation-archive/26-01-SUMMARY.md
@workflows-backup/README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Export 3 missing sub-workflows to workflows-backup/</name>
  <files>
    workflows-backup/holwGQuksZPsSb19-status-pre-checkin.json
    workflows-backup/NUZv1Gt15LKyiiKz-buscar-instrucoes.json
    workflows-backup/Pc0PyATrZaGefiSJ-processar-documento.json
  </files>
  <action>
Export the 3 sub-workflows that are NOT yet backed up:

1. holwGQuksZPsSb19 (Tool: Consultar Status Pre Check-In)
   - Use mcp__n8n-mcp__n8n_get_workflow to get full JSON
   - Save to: workflows-backup/holwGQuksZPsSb19-status-pre-checkin.json
   - Verify: JSON has "nodes" array with multiple nodes

2. NUZv1Gt15LKyiiKz (Tool: Buscar Instrucoes)
   - Use mcp__n8n-mcp__n8n_get_workflow to get full JSON
   - Save to: workflows-backup/NUZv1Gt15LKyiiKz-buscar-instrucoes.json
   - Verify: JSON has "nodes" array with multiple nodes

3. Pc0PyATrZaGefiSJ (Tool: Processar Documento)
   - Use mcp__n8n-mcp__n8n_get_workflow to get full JSON
   - Save to: workflows-backup/Pc0PyATrZaGefiSJ-processar-documento.json
   - Verify: JSON has "nodes" array with multiple nodes

For each export:
- Format JSON with proper indentation (2 spaces)
- Verify file size > 500 bytes (not empty/truncated)
- Verify JSON is parseable (run through jq if available)

The other 7 sub-workflows already have backups in workflows-backup/.
  </action>
  <verify>
Run: ls -la workflows-backup/holwGQuksZPsSb19-status-pre-checkin.json workflows-backup/NUZv1Gt15LKyiiKz-buscar-instrucoes.json workflows-backup/Pc0PyATrZaGefiSJ-processar-documento.json
All 3 files should exist with size > 500 bytes.

Run: cat workflows-backup/holwGQuksZPsSb19-status-pre-checkin.json | head -5
Should show valid JSON with workflow structure.
  </verify>
  <done>All 3 missing sub-workflows exported to workflows-backup/ with valid JSON containing nodes and connections.</done>
</task>

<task type="auto">
  <name>Task 2: Deactivate all 10 sub-workflows in N8N</name>
  <files>N8N workflows (no local files modified)</files>
  <action>
Deactivate all 10 sub-workflows using N8N MCP. DO NOT DELETE - only deactivate.

Sub-workflows to deactivate (by ID):
1. 8Bke6sYr7r51aeEq - buscar_slots_disponiveis
2. 8Ug0F3KuLov6EeCQ - buscar_agendamentos
3. igG6sZsStxiDzNRY - buscar_paciente
4. holwGQuksZPsSb19 - status_pre_checkin
5. NUZv1Gt15LKyiiKz - buscar_instrucoes
6. eEx2enJk3YpreNUm - criar_agendamento
7. 21EHe24mkMmfBhK6 - reagendar_agendamento
8. gE2rpbLVUlnA5yMk - cancelar_agendamento
9. 4DNyXp5fPPfsFOnR - atualizar_dados_paciente
10. Pc0PyATrZaGefiSJ - processar_documento

For each workflow:
1. Use mcp__n8n-mcp__deactivate_workflow with workflowId
2. Verify deactivation by calling mcp__n8n-mcp__n8n_get_workflow and checking active=false

IMPORTANT:
- DO NOT use delete operations
- If workflow is already inactive, skip (no error)
- Log each deactivation for audit trail
  </action>
  <verify>
For each workflow ID, use mcp__n8n-mcp__n8n_get_workflow and verify:
- active: false
- Workflow still exists (not deleted)

All 10 should show active=false.
  </verify>
  <done>All 10 sub-workflows are deactivated (active=false) but still exist in N8N for potential rollback.</done>
</task>

<task type="auto">
  <name>Task 3: Update workflows-backup/README.md with archive status</name>
  <files>workflows-backup/README.md</files>
  <action>
Update the README.md in workflows-backup/ to reflect completed archive status.

Update the Sub-Workflow Inventory table to show all 10 as exported:

| # | Workflow ID | File Name | Export Date | Size | Status |
|---|-------------|-----------|-------------|------|--------|
| 1 | `8Bke6sYr7r51aeEq` | `8Bke6sYr7r51aeEq-buscar-slots-disponiveis.json` | 2026-01-15 | 7 KB | Archived |
| 2 | `eEx2enJk3YpreNUm` | `eEx2enJk3YpreNUm-criar-agendamento.json` | 2026-01-15 | 8.5 KB | Archived |
| 3 | `21EHe24mkMmfBhK6` | `21EHe24mkMmfBhK6-reagendar-agendamento.json` | 2026-01-13 | 2.4 KB | Archived |
| 4 | `gE2rpbLVUlnA5yMk` | `gE2rpbLVUlnA5yMk-cancelar-agendamento.json` | Existing | 2.2 KB | Archived |
| 5 | `8Ug0F3KuLov6EeCQ` | `8Ug0F3KuLov6EeCQ-buscar-agendamentos.json` | 2026-01-13 | 2.6 KB | Archived |
| 6 | `igG6sZsStxiDzNRY` | `igG6sZsStxiDzNRY-buscar-paciente.json` | Existing | 3.1 KB | Archived |
| 7 | `4DNyXp5fPPfsFOnR` | `4DNyXp5fPPfsFOnR-atualizar-dados-paciente.json` | 2026-01-15 | 4.8 KB | Archived |
| 8 | `NUZv1Gt15LKyiiKz` | `NUZv1Gt15LKyiiKz-buscar-instrucoes.json` | 2026-01-25 | TBD | Archived |
| 9 | `Pc0PyATrZaGefiSJ` | `Pc0PyATrZaGefiSJ-processar-documento.json` | 2026-01-25 | TBD | Archived |
| 10 | `holwGQuksZPsSb19` | `holwGQuksZPsSb19-status-pre-checkin.json` | 2026-01-25 | TBD | Archived |

Add archive completion section at the end:

---

## Archive Completion

**Archive Date:** 2026-01-25
**Archived By:** Claude (Phase 26)
**Status:** COMPLETE

All 10 AI Agent tool sub-workflows have been:
- Exported to this directory as JSON files
- Committed to git for version control
- Deactivated in N8N (not deleted)

The migration from toolWorkflow to toolHttpRequest is complete. These sub-workflows are retained for emergency rollback only.

**Migration Phase:** v2.1 N8N Agent HTTP Tools Migration
**Completed Plans:** 23-01 through 26-02
  </action>
  <verify>
Read workflows-backup/README.md and confirm:
- Inventory table shows all 10 as "Archived"
- Archive Completion section exists at end
- Archive date is 2026-01-25
  </verify>
  <done>README.md updated with complete archive status, all 10 workflows marked as archived with dates.</done>
</task>

</tasks>

<verification>
After all tasks:
1. 3 new JSON files exist in workflows-backup/
2. All 10 sub-workflows are deactivated in N8N (verified via MCP)
3. README.md has updated inventory with all "Archived"
4. README.md has Archive Completion section
5. Git commit includes all changes
</verification>

<success_criteria>
- All 10 sub-workflows have JSON exports in workflows-backup/
- All 10 sub-workflows are deactivated (not deleted) in N8N
- README.md documents archive completion
- All changes committed to git
- v2.1 migration is complete
</success_criteria>

<output>
After completion, create `.planning/phases/26-validation-archive/26-02-SUMMARY.md`
</output>
