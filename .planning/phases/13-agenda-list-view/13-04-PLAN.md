---
phase: 13-agenda-list-view
plan: 04
type: execute
wave: 2
depends_on: [13-01]
files_modified:
  - src/components/agenda/agenda-list-cards.tsx
autonomous: true

must_haves:
  truths:
    - "Mobile view shows card layout instead of table"
    - "Each card displays all appointment info and action buttons"
    - "Cards are visually consistent with existing card patterns"
  artifacts:
    - path: "src/components/agenda/agenda-list-cards.tsx"
      provides: "Mobile card layout for agenda list"
      exports: ["AgendaListCards"]
  key_links:
    - from: "src/components/agenda/agenda-list-cards.tsx"
      to: "src/components/appointments/no-show-risk-badge.tsx"
      via: "NoShowRiskBadge import"
      pattern: "import.*NoShowRiskBadge"
---

<objective>
Create mobile card layout for the agenda list view.

Purpose: Implement ALIST-12 (mobile responsive card layout) that shows appointment data in card format on mobile devices.
Output: AgendaListCards component that renders as cards on mobile screens.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/13-agenda-list-view/13-RESEARCH.md
@.planning/phases/13-agenda-list-view/13-01-SUMMARY.md

@src/lib/validations/appointment.ts
@src/components/lembretes-enviados/lembrete-enviado-table.tsx
@src/components/appointments/no-show-risk-badge.tsx
@src/components/ui/badge.tsx
@src/components/ui/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AgendaListCards component</name>
  <files>src/components/agenda/agenda-list-cards.tsx</files>
  <action>
    Create mobile card layout component for appointments:

    1. Props interface (same as table):
       ```typescript
       interface AgendaListCardsProps {
         data: AppointmentListItem[]
         onEdit: (id: string) => void
         onConfirm: (id: string) => void
         onCancel: (id: string) => void
         onRowClick?: (id: string) => void
       }
       ```

    2. Render as `<div className="md:hidden space-y-3">` (hidden on desktop)

    3. Card structure for each appointment:
       ```tsx
       <div
         key={appointment.id}
         className="bg-white rounded-lg border p-4 space-y-3"
         onClick={() => onRowClick?.(appointment.id)}
       >
         {/* Header: Patient name + Risk badge */}
         <div className="flex items-start justify-between">
           <div>
             <h3 className="font-semibold text-gray-900">{appointment.patientName}</h3>
             <div className="flex items-center gap-2 mt-1">
               <Badge variant={statusVariant}>{statusLabel}</Badge>
             </div>
           </div>
           {showRiskBadge && <NoShowRiskBadge appointmentId={appointment.id} />}
         </div>

         {/* Details grid */}
         <div className="space-y-1 text-sm">
           <div className="flex justify-between">
             <span className="text-gray-500">Data/Hora:</span>
             <span className="text-gray-900">{formattedDateTime}</span>
           </div>
           <div className="flex justify-between">
             <span className="text-gray-500">Servico:</span>
             <span className="text-gray-900">{appointment.serviceType}</span>
           </div>
           <div className="flex justify-between">
             <span className="text-gray-500">Profissional:</span>
             <span className="text-gray-900 flex items-center gap-1">
               <span
                 className="w-2 h-2 rounded-full"
                 style={{ backgroundColor: appointment.providerColor }}
               />
               {appointment.providerName}
             </span>
           </div>
           {appointment.patientPhone && (
             <div className="flex justify-between">
               <span className="text-gray-500">Telefone:</span>
               <span className="text-gray-900 font-mono">{appointment.patientPhone}</span>
             </div>
           )}
         </div>

         {/* Action buttons */}
         <div className="flex gap-2 pt-2 border-t">
           <Button variant="outline" size="sm" className="flex-1" onClick={(e) => { e.stopPropagation(); onEdit(appointment.id) }}>
             <Pencil className="h-4 w-4 mr-1" />
             Editar
           </Button>
           {showConfirm && (
             <Button variant="outline" size="sm" className="flex-1" onClick={(e) => { e.stopPropagation(); onConfirm(appointment.id) }}>
               <Check className="h-4 w-4 mr-1" />
               Confirmar
             </Button>
           )}
           {showCancel && (
             <Button variant="outline" size="sm" className="flex-1 text-red-600 hover:text-red-700" onClick={(e) => { e.stopPropagation(); onCancel(appointment.id) }}>
               <X className="h-4 w-4 mr-1" />
               Cancelar
             </Button>
           )}
         </div>
       </div>
       ```

    4. Status badge styling:
       - agendada: variant="outline"
       - confirmado: variant="default" with green background
       - cancelada: variant="destructive"
       - realizada: variant="secondary"
       - faltou: variant="destructive"

    5. Risk badge visibility:
       - Only show for future appointments
       - Only show if status not in [cancelada, realizada, faltou]

    6. Date formatting:
       - Use format(dbTimestampToTZDate(scheduledAt), 'dd/MM/yyyy HH:mm', { locale: ptBR })

    7. Action button visibility:
       - Edit: Always visible
       - Confirm: Only if status === 'agendada'
       - Cancel: Only if status in ['agendada', 'confirmado']

    8. Empty state:
       - Show same empty state as table (Calendar icon, "Nenhum agendamento encontrado")

    Follow pattern from `lembrete-enviado-table.tsx` mobile card section.
  </action>
  <verify>
    TypeScript compiles: `npx tsc --noEmit`
    Component renders cards with all appointment details and action buttons.
  </verify>
  <done>Mobile card layout renders all appointment info with actions, hidden on desktop.</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors
2. Cards show all appointment info (patient, date, service, provider, status, phone)
3. Status badges use correct colors
4. No-show risk badge shows for eligible appointments
5. Action buttons show with correct visibility
6. Cards are hidden on desktop (md:hidden class)
7. onClick handlers work for card tap and individual buttons
</verification>

<success_criteria>
- Mobile card layout displays appointment data (ALIST-12)
- Each card shows patient name, date/time, service, provider, status
- Quick actions (Edit, Confirm, Cancel) work from cards (ALIST-09)
- No-show risk badge shows where appropriate (ALIST-10)
- Cards only visible on mobile (md:hidden)
</success_criteria>

<output>
After completion, create `.planning/phases/13-agenda-list-view/13-04-SUMMARY.md`
</output>
